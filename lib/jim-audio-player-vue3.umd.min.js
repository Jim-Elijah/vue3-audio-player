(function(e,t){"object"===typeof exports&&"object"===typeof module?module.exports=t(require("vue")):"function"===typeof define&&define.amd?define([],t):"object"===typeof exports?exports["jim-audio-player-vue3"]=t(require("vue")):e["jim-audio-player-vue3"]=t(e["Vue"])})("undefined"!==typeof self?self:this,(function(e){return function(){"use strict";var t={744:function(e,t){t.Z=(e,t)=>{const r=e.__vccOpts||e;for(const[i,s]of t)r[i]=s;return r}},203:function(t){t.exports=e}},r={};function i(e){var s=r[e];if(void 0!==s)return s.exports;var n=r[e]={exports:{}};return t[e](n,n.exports,i),n.exports}!function(){i.d=function(e,t){for(var r in t)i.o(t,r)&&!i.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){i.p=""}();var s={};return function(){if(i.r(s),i.d(s,{default:function(){return y}}),"undefined"!==typeof window){var e=window.document.currentScript,t=e&&e.src.match(/(.+\/)[^/]+\.js(\?.*)?$/);t&&(i.p=t[1])}var r=i(203);const n={class:"audio-player-box"},o=["src"],a=(0,r.createTextVNode)(" 您的浏览器不支持音频播放 ");function u(e,t,i,s,u,d){return(0,r.openBlock)(),(0,r.createElementBlock)("div",n,[(0,r.createElementVNode)("audio",{onCanplay:t[0]||(t[0]=(...e)=>d.updateDuration&&d.updateDuration(...e)),onEnded:t[1]||(t[1]=(...e)=>d.endedHandler&&d.endedHandler(...e)),onTimeupdate:t[2]||(t[2]=(...e)=>d.updateTime&&d.updateTime(...e)),controls:"",ref:"audioRef",style:{display:"none"}},[(0,r.createElementVNode)("source",{src:i.src},null,8,o),a],544),(0,r.renderSlot)(e.$slots,"default",{currentTime:u.currentTime,duration:u.duration,isPlaying:u.isPlaying,isMuted:d.isMuted,noMusic:d.noMusic,onProgressBarClick:d.progressBarClickHandler,OnProgressMousedown:d.progressMousedownHandler,onVolumeBarClick:d.volumeBarClickHandler,togglePlay:d.togglePlay,back:d.back,forward:d.forward})])}var d={name:"Vue3AudioPlayer",props:{src:{type:String,default:""},forwardStep:{type:Number,default:3},backStep:{type:Number,default:3},muteThreshold:{type:Number,default:.08},currentRef:{type:Object,default:()=>({})},progressBarRefName:{type:String,default:"progressBarRef"},progressRefName:{type:String,default:"progressRef"},volumeBarRefName:{type:String,default:"volumeBarRef"},volumeRefName:{type:String,default:"volumeRef"}},data(){return{isPlaying:!1,currentTime:"00:00",duration:"00:00",audioVolume:.5,isMoving:!1,savedIsPlaying:!1}},computed:{isMuted(){return this.audioVolume<this.muteThreshold},audioRef(){const{audioRef:e={}}=this.currentRef.$refs||{};return e},noMusic(){return"00:00"===this.duration},progressBarRef(){return this.$parent.$refs[this.progressBarRefName]||{}},progressRef(){return this.$parent.$refs[this.progressRefName]||{}},volumeBarRef(){return this.$parent.$refs[this.volumeBarRefName]||{}},volumeRef(){return this.$parent.$refs[this.volumeRefName]||{}}},methods:{updateDuration(){const e=this.audioRef;this.duration=this.transTime(e.duration),e.loop=!1,e.volume=.5,this.audioVolume=.5},endedHandler(){this.isPlaying=!1},togglePlay(){if(this.noMusic)return;const e=this.audioRef;this.currentTime===this.duration&&(this.currentTime="00:00",e.currentTime=0,this.progressBarRef.style.width="0%"),this.isPlaying?(e.pause(),this.isPlaying=!1):(e.play(),this.isPlaying=!0)},back(){if(this.noMusic)return;const e=this.audioRef;let t=e.currentTime-this.backStep;t<0&&(t=0),e.currentTime=t,this.currentTime=this.transTime(t)},forward(){if(this.noMusic)return;const e=this.audioRef;let t=e.currentTime+this.forwardStep;t>e.duration&&(t=e.duration),e.currentTime=t,this.currentTime=this.transTime(t)},updateTime(){const e=this.audioRef,t=e.currentTime/e.duration,r=this.progressRef;r?(r.style.width=100*t+"%",1===t&&(this.isPlaying=!1)):this.isPlaying=!1,this.currentTime=this.transTime(e.currentTime)},transTime(e){var t=parseInt(e),r=parseInt(t/60),i=t%60+"",s=":";return 0===r?r="00":r<10&&(r="0"+r),1===i.length&&(i="0"+i),r+s+i},updateProgress(e){const t=this.progressBarRef,r=this.progressRef,i=this.audioRef,s=t.clientWidth,n=e/s,o=100*n;r.style.width=o+"%",i.currentTime=i.duration*n,this.currentTime=this.transTime(i.currentTime)},progressBarClickHandler(e){this.noMusic||this.isMoving&&!this.isPlaying||this.updateProgress(e.offsetX)},volumeBarClickHandler(e){if(this.noMusic)return;const t=this.volumeBarRef,r=this.volumeRef,i=this.audioRef,s=t.clientHeight,n=e.offsetY/s,o=100*n,a=n<this.muteThreshold,u=a?0:n;r.style.height=a?"0%":o+"%",i.volume=u,this.audioVolume=u},progressMousedownHandler(){if(this.noMusic)return;this.savedIsPlaying=this.isPlaying,this.audioRef.pause(),this.isPlaying=!1,this.isMoving=!0;const e=this.progressBarRef;let t=e.offsetParent.offsetLeft+e.offsetLeft,r=e.offsetParent.offsetLeft+e.offsetLeft+e.clientWidth,i=e=>{e.pageX>=r||e.pageX<=t||this.updateProgress(e.pageX-t)};document.addEventListener("mousemove",i,!1),document.addEventListener("mouseup",(()=>{setTimeout((()=>{this.isMoving=!1,this.savedIsPlaying&&(this.audioRef.play(),this.isPlaying=this.savedIsPlaying,this.savedIsPlaying=!this.savedIsPlaying)}),200),document.removeEventListener("mousemove",i,!1)}),!1)}}},f=i(744);const l=(0,f.Z)(d,[["render",u]]);var c=l;c.install=function(e){e.component(c.name,c)};var m=c;const p=[m],h=function(e){h.installed||p.forEach((t=>{e.component(t.name,t),e.config.globalProperties[t.name]=t.name+"1"}))};"undefined"!==typeof window&&window.Vue&&h(window.Vue);var g={install:h,Vue3AudioPlayer:m},y=g}(),s}()}));
//# sourceMappingURL=jim-audio-player-vue3.umd.min.js.map